{% extends 'PC/baseForm.html'%}
{% block title %}
更改库存信息|{{ inventory.inventory_name }}
{% endblock %}
{% block body-title %}
更改库存信息|{{ inventory.inventory_name }}
{% endblock %}
{% block style %}

{% endblock %}
{% block form %}
    <div class="pure-control-group">
        <label for="inventory_name">库存名称</label>
        <input type="text" id="inventory_name" name="inventory_name" value="{{ inventory.inventory_name }}" placeholder="请输入库存名称" required maxlength="20"/>
    </div>
    <div class="pure-control-group">
        <label for="inventory_category">库存类别</label>
        <input type="text" id="inventory_category" name="inventory_category" value="{{ inventory.inventory_category }}" required maxlength="12"/>
    </div>
    <div class="pure-control-group">
        <label for="inventory_unit">单位</label>
        <input type="text" id="inventory_unit" name="inventory_unit" value="{{ inventory.inventory_unit }}" maxlength="12" required/>
    </div>
    <div class="pure-control-group">
        <label for="inventory_details">详细信息</label>
        <textarea rows="5" cols="20" maxlength="300" id="inventory_details" name="inventory_details" placeholder="请输入详细信息" required>{{ inventory.inventory_details }}</textarea>
    </div>
{% endblock %}
{% block button-text %}
<i class="iconfont icon-wancheng"></i> 提交
{% endblock %}
{% block script %}
<script>
$(document).ready(function () {
    let error = $('.error');
    let inventory_id = $('#inventory_id');
    let login_button = $('.form-button');
    login_button.click(function () {
        login_button.html('<i class="iconfont icon-jiazai"></i> 请稍后...').attr('disabled', 'disabled');  // 改变button中的文字
        $.ajax({
            url: "{% url 'BPlan:inventory_create_add' %}",
            type: 'POST',
            data: {
                'inventory_id': inventory_id.val(),
                'inventory_name': $('#inventory_name').val(),
                'inventory_category': $('#inventory_category').val(),
                'inventory_num': $('#inventory_num').val(),
                'inventory_unit': $('#inventory_unit').val(),
                'inventory_details': $('#inventory_details').val(),
                "csrfmiddlewaretoken":$("[name='csrfmiddlewaretoken']").val(),
            },
            success: function (result) {
                if (result === 'codeWrong'){
                    error.text('验证码错误！');
                    code.val("");
                    refreshSrc();
                    login_button.html('<i class="iconfont icon-wancheng"></i> 提交').removeAttr('disabled');
                    return 0;
                }
                if (result === 'idExist') {
                    error.text('您输入的库存id已经存在');
                    inventory_id.val("");
                    code.val("");
                    refreshSrc();
                    login_button.html('<i class="iconfont icon-wancheng"></i> 提交').removeAttr('disabled');
                    return 0;
                }
                if (result === 'success') {
                    error.text("");
                    $("form").hide(1000);
                    $(".body-title").html("<i class=\"iconfont icon-wancheng\"></i> 注册成功");
                    return 1;
                }
            },
        })
    })
})
</script>
{% endblock %}